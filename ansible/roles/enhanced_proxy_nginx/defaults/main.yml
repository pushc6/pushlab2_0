---
# roles/enhanced_proxy_nginx/defaults/main.yml
# Default values for Enhanced Proxy Nginx role (OAuth2 + Traditional)

# Default proxy mode
default_proxy_mode: "oauth2"  # Options: "oauth2" or "traditional"

# OAuth2-Proxy settings
oauth2_proxy_host: "localhost"
oauth2_proxy_port: "4180"

# Traditional proxy defaults
traditional_proxy_config:
  enable_caching: false
  cache_valid_time: "1h"
  cache_bypass_headers:
    - "Cache-Control"
    - "Pragma"
  enable_gzip: true
  gzip_level: 6
  proxy_buffering: "off"
  client_max_body_size: "100M"
  proxy_timeout: "60s"
  enable_rate_limiting: false
  rate_limit: "10r/s"
  burst_limit: 20
  enable_access_logs: true
  enable_error_logs: true
  log_format: "proxy_combined"
  hide_backend_headers: true
  enable_status_page: false
  custom_error_pages: false
  keepalive_timeout: "65s"
  keepalive_requests: 100

# Nginx settings
nginx_proxy_timeout: "60s"
nginx_client_max_body_size: "100M"

# Default paths
nginx_sites_available: "/etc/nginx/sites-available"
nginx_sites_enabled: "/etc/nginx/sites-enabled"
nginx_conf_d: "/etc/nginx/conf.d"

# SSL settings
ssl_protocols: "TLSv1.2 TLSv1.3"
ssl_ciphers: "HIGH:!aNULL:!MD5"
ssl_prefer_server_ciphers: "off"
ssl_session_timeout: "1d"
ssl_session_tickets: "off"
ssl_stapling_enabled: true
ssl_resolver: "8.8.8.8 8.8.4.4"
ssl_resolver_timeout: "5s"

# Security headers defaults
hsts_max_age: "63072000"
hsts_preload: true
x_frame_options: "DENY"
x_content_type_options: "nosniff"
x_xss_protection: "1; mode=block"
referrer_policy: "strict-origin-when-cross-origin"

# Default authentication settings
default_auth_type: "simple"
default_ssl_domain: "localhost"

# Service filtering (empty means all services)
oauth2_services_filter: []

# Logout configuration defaults
logout_config:
  enable_id_token_logout: true
  enable_sso_logout: true
  enable_force_logout: true
  enable_logout_success_page: true
  keycloak_realm: "prod"
  keycloak_client_id: "oauth2-proxy-multi-domain"
  logout_success_redirect: true

# Nginx configuration defaults
nginx_config:
  proxy_timeout: "60s"
  client_max_body_size: "100M"
  proxy_buffering: "off"
  proxy_request_buffering: "off"
  proxy_http_version: "1.1"
  keepalive_timeout: "65s"
  send_timeout: "60s"
  read_timeout: "60s"

# Monitoring defaults
monitoring:
  access_log_format: "combined"
  error_log_level: "warn"
  enable_metrics: false
  metrics_endpoint: "/nginx_status"

# SELinux defaults
selinux_config:
  auto_configure: true
  install_tools: true
  configure_booleans: true
  configure_ports: true
  verify_config: true
  force_reconfigure: false
  skip_on_disabled: true
